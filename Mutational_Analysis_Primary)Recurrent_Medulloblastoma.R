#Workflow to generate the mutation profile for primary and Recurrent medulloblastoma
#There are 14 samples with matched germline, primary and recurrent samples 
#There are ... samples with matched primary and recurrent medulloblastoma samples. 
#There are ...samples with matched germline and recurrent medulloblastoma samples.
#Packages used 
maftools::
ggplot2::
RColorBrewer::
ggthemes::
scales::
##Recurrent cases , recurrent occured at metstatic site. The MAF file was generated by Megan Bowman
Germline_Met_Recur<- read.delim("~/Desktop/Data_Analysis/last MAF files/ICGC_germline_metastatic_reduced_maf_final.txt", header=TRUE)
View(Germline_Met_Recur)
Germline_Met_Recur_Maf <- read.maf(maf = "~/Desktop/Data_Analysis/last MAF files/ICGC_germline_metastatic_reduced_maf_final.txt")
mafSummary(Germline_Met_Recur_Maf)
plotmafSummary(Germline_Met_Recur_Maf)

##Recurrent cases , recurrent occured at primary site. The MAF file was generated by Ian Beddows
Germline_Recur_Maf <- read.maf(maf = "~/Desktop/Data_Analysis/last MAF files/9_recurrent_germline_samples_GRCH38_crossmapped_to_GRCH37.maf.txt")
mafSummary(Germline_Recur_Maf)
## recurrent cases, recurrence occured at primary site, but these are cases which for which the varianst are called against primary tumor and in cases where primary was not presnt against Germline
##Files were generated by Megan Bowman
Recur_Maf <- read.maf(maf = "~/Desktop/Data_Analysis/Data_Files/recurrence_primary_site/Primary_recurrent_reduced_maf_final.txt")
mafSummary(Recur_Maf)
## Primary cases there are only 15 cases for which matched germline was present. 
Germline_Primary <- read_csv("~/Desktop/Data_Analysis/last MAF files/primary_germline_15_files.maf.txt")
Primary_Medulloblastoma<- read.maf(maf = "~/Desktop/Data_Analysis/last MAF files/primary_germline_15_files.maf.txt")
mafSummary(Primary_Medulloblastoma)
##created a data frame of all varianet types and classification in primary and recurrent medulloblastoma ICGC data 
##40 recurrent samples and a total of 15 primary meduloblastoma cases. 
Variant_Medulloblastoma_Primary_and_Recurrent <- read_csv("Variant_Medulloblastoma_Primary_and_Recurrent.csv")
View(Variant_Medulloblastoma_Primary_and_Recurrent)
## Removed the additional NA row from the data frame
Variant_Medulloblastoma_Primary_and_Recurrent <- Variant_Medulloblastoma_Primary_and_Recurrent[-c(56), ]
##final Data Frame  Variant_Medulloblastoma_Primary_and_Recurrent
str(Variant_Medulloblastoma_Primary_and_Recurrent)
Variant_Medulloblastoma_Primary_and_Recurrent <- as.data.frame(Variant_Medulloblastoma_Primary_and_Recurrent)
str(Variant_Medulloblastoma_Primary_and_Recurrent)

## Data visulaization total number of variants in primay and Recurrent Medulloblastoma
X <- ggplot(data = Variant_Medulloblastoma_Primary_and_Recurrent, aes(Variant_Medulloblastoma_Primary_and_Recurrent$TYPE, Variant_Medulloblastoma_Primary_and_Recurrent$Total))+geom_boxplot()+ theme_grey() + ggtitle("Total Variants") + xlab("Medulloblastoma") + ylab("Variants") + geom_boxplot(aes(fill = TYPE)) + scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))
X + scale_fill_brewer(palette = "Set1") 

## Data visulaization total number of misense mutation inprimary and Recurrent medulloblastoma
Y <- ggplot(data = Variant_Medulloblastoma_Primary_and_Recurrent, aes(Variant_Medulloblastoma_Primary_and_Recurrent$TYPE, Variant_Medulloblastoma_Primary_and_Recurrent$Missense_Mutation))+geom_boxplot()+ theme_grey() + ggtitle("Missense Mutations") + xlab("Medulloblastoma") + ylab("Missense Mutations") + geom_boxplot(aes(fill = TYPE)) + scale_y_log10(breaks = trans_breaks("log10", function(x) 10^x),labels = trans_format("log10", math_format(10^.x)))
Y + scale_fill_brewer(palette = "Set1")
## Data visulaization total number of mutations in non-codding region primary and Recurrent medulloblastoma
Z <- ggplot(data = Variant_Medulloblastoma_Primary_and_Recurrent, aes(Variant_Medulloblastoma_Primary_and_Recurrent$TYPE, Variant_Medulloblastoma_Primary_and_Recurrent$Intron))+geom_boxplot()+ theme_grey() + ggtitle("Mutations in  Non-Coding Region") + xlab("Medulloblastoma") + ylab("Mutations") + geom_boxplot(aes(fill = TYPE)) + scale_y_continuous(trans = log2_trans(), breaks = trans_breaks("log2", function(x) 2^x))
Z + scale_fill_brewer(palette = "Set1")
## Data visulaization of Non-Synonymous_Mutations of primarya and recurrent mutations.
V <- ggplot(data = Variant_Medulloblastoma_Primary_and_Recurrent, aes(Variant_Medulloblastoma_Primary_and_Recurrent$TYPE, Variant_Medulloblastoma_Primary_and_Recurrent$`Non-Synonymous_Mutations`))+geom_boxplot()+ theme_grey() + ggtitle("Non-Synonymous_Mutations") + xlab("Medulloblastoma") + ylab("Non-Synonymous_Mutations") + geom_boxplot(aes(fill = TYPE)) + scale_y_continuous(trans = log2_trans(), breaks = trans_breaks("log2", function(x) 2^x))
V + scale_fill_brewer(palette="Set1")
